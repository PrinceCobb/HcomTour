<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HCOM Tour</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <style>
    #play-button {
      position: absolute;
      top: calc(50% - 25px);
      left: calc(50% - 50px - 45px);
      width: 180px;
      height: 70px;
      z-index: 10;
      background-color: #006a4b;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 18px;
      cursor: pointer;
    }
    .hidden {
      display: none;
      pointer-events: none; /* Disable clicks */
    }
    .clickable {
      pointer-events: auto; /* Enable clicks for clickable items */
    }
  </style>
</head>
<body>
  <button id="play-button">Start Experience</button>
  <a-scene id="scene" loading-screen="enabled:false">
    <a-assets>
      <video id="intro-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/webm/intro.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-two-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/small/OMM.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-three-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/small/Anatomy.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-four-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/small/CTAC.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-five-video" src=".mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-six-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/small/Student.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-seven-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/small/Classrooms.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-eight-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/small/Fitness.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <video id="scene-nine-video" src="http://m2qall8jajdg-hls-push.5centscdn.com/mp4/small/Admission.mp4" crossorigin="anonymous" playsinline muted preload="auto"></video>
      <img id="ommlab-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/OMM.png" crossorigin="anonymous" />
      <img id="admin-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/Admission.png" crossorigin="anonymous" />
      <img id="anatomy-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/Anatomy.png" crossorigin="anonymous" />
      <img id="cafe-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/student.png" crossorigin="anonymous" />
      <img id="clinical-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/Clinical.png" crossorigin="anonymous" />
      <img id="fitness-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/Fitness.png" crossorigin="anonymous" />
      <img id="study-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/Classroom.png" crossorigin="anonymous" />
      <img id="translation-normal" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/Translational.png" crossorigin="anonymous" />
      <img id="homebtn" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/shwoptns.png" crossorigin="anonymous" />
      <img id="optionsbtn" src="http://m2qall8jajdg-hls-push.5centscdn.com/btn/showoptionsbtn2.png" crossorigin="anonymous" />
    </a-assets>
   <a-videosphere id="video-sky" src="#intro-video" rotation="0 268 0" playsinline></a-videosphere>
    <a-camera>
      <a-cursor raycaster="objects: .clickable" color="yellow"></a-cursor>
    </a-camera>
    <a-entity id="menubtn" position="-0.05 0 0" class="hidden" visible="false">
      <a-image src="#ommlab-normal" width="1.5" height="0.39" position="-1.5 1.25 -5" class="clickable" id="ommlab"></a-image>
      <a-image src="#anatomy-normal" width="1.5" height="0.39" position="-1.5 0.75 -5" class="clickable" id="anatomy"></a-image>
      <a-image src="#clinical-normal" width="1.5" height="0.39" position="-1.5 0.25 -5" class="clickable" id="clinical"></a-image>
      <a-image src="#translation-normal" width="1.5" height="0.39" position="-1.5 -0.25 -5" class="clickable" id="translation"></a-image>
      <a-image src="#cafe-normal" width="1.5" height="0.39" position="1.5 1.25 -5" class="clickable" id="cafe"></a-image>
      <a-image src="#study-normal" width="1.5" height="0.39" position="1.5 0.75 -5" class="clickable" id="study"></a-image>
      <a-image src="#fitness-normal" width="1.5" height="0.39" position="1.5 0.25 -5" class="clickable" id="fitness"></a-image>
      <a-image src="#admin-normal" width="1.5" height="0.39" position="1.5 -0.25 -5" class="clickable" id="admin"></a-image>
    </a-entity>
    <a-entity id="home" position="-0.382 -1 -5" class="hidden" visible="false">
      <a-image src="#homebtn" width="1.5" height="0.39" position="-0.234 0 0.01" class="clickable" id="homebtn"></a-image>
    </a-entity>
     <!-- <a-entity id="options" position="1.238 -1 -5" class="hidden" visible="false">
      <a-image src="#optionsbtn" width="1.5" height="0.39" position="-0.454 0 0.01" class="clickable" id="optionbtn"></a-image>
    </a-entity> -->
  </a-scene>

 <script>
const playButton = document.getElementById("play-button");
const scene = document.getElementById("scene");
const introVideo = document.getElementById("intro-video");
const secVideo = document.getElementById("scene-two-video");
const thirdVideo = document.getElementById("scene-three-video");
const fourthVideo = document.getElementById("scene-four-video");
const fifthVideo = document.getElementById("scene-five-video");
const sixthVideo = document.getElementById("scene-six-video");
const sevVideo = document.getElementById("scene-seven-video");
const eigVideo = document.getElementById("scene-eight-video");
const nineVideo = document.getElementById("scene-nine-video");
const menu = document.getElementById("menubtn");
const videoSky = document.getElementById("video-sky");
const homebtn = document.getElementById("home");
const cursor = document.querySelector("a-cursor");

const allVideos = [
  introVideo, secVideo, thirdVideo, fourthVideo,
  fifthVideo, sixthVideo, sevVideo, eigVideo, nineVideo
];

//  Disable cursor interactions at the start
cursor.setAttribute("raycaster", "objects: none");

//  Play Experience Button
playButton.addEventListener("click", () => {
  playButton.style.display = "none";
  scene.style.visibility = "visible";

  introVideo.muted = false; // Unmute
  introVideo.currentTime = 0; // Restart the video
  introVideo.play().catch((e) => console.error("Playback Error:", e));
});

//  Store last timestamp for `intro-video`
let introVideoPauseTime = 0;

// Handle Video End Logic
function handleVideoEnd(video) {
  video.addEventListener("ended", () => {
    console.log(`Video ${video.id} ended.`);

    if (video.id === "intro-video") {
      //  Show menu only after intro video
      menu.setAttribute("visible", true);
      menu.classList.remove("hidden");

      //  Enable cursor interactions for menu
      cursor.setAttribute("raycaster", "objects: .clickable");
    } else {
      //  Hide menu for other videos
      menu.setAttribute("visible", false);
      menu.classList.add("hidden");

      //  Show home button at the end of other videos
      homebtn.setAttribute("visible", true);
      homebtn.classList.remove("hidden");

      //  Enable cursor interactions only when `homebtn` appears
      cursor.setAttribute("raycaster", "objects: .clickable");
    }
  });
}

// Attach event listener to each video
allVideos.forEach(handleVideoEnd);

//  Function to Switch Videos
function switchVideo(videoId) {
  allVideos.forEach((vid) => vid.pause());

  videoSky.setAttribute("src", `#${videoId}`);
  const newVideo = document.getElementById(videoId);
  newVideo.currentTime = 0;
  newVideo.muted = false;
  newVideo.play().catch((e) => console.error(e));

  //  Hide Menu & Home Button During Video Play
  menu.setAttribute("visible", false);
  menu.classList.add("hidden");

  homebtn.setAttribute("visible", false);
  homebtn.classList.add("hidden");

  //  Disable cursor interactions until the home button appears
  cursor.setAttribute("raycaster", "objects: none");

  //  Show Home Button Only When NOT Intro Video
  if (videoId === "intro-video") {
    homebtn.setAttribute("visible", false);
    homebtn.classList.add("hidden");
  }
}

//  Home Button Click: Return to Intro Video & Show Menu
document.getElementById("home").addEventListener("click", () => {
  switchVideo("intro-video");

  //  Resume intro video from where the menu appears (approx. last 4 seconds)
  introVideo.currentTime = introVideoPauseTime || (introVideo.duration - 4);
  introVideo.pause(); // Pause it so menu is visible immediately
  console.log(`Returning to intro video at ${introVideo.currentTime} seconds.`);

  //  Show the menu immediately when home button is clicked
  menu.setAttribute("visible", true);
  menu.classList.remove("hidden");

  //  Enable cursor interactions when returning to intro video
  cursor.setAttribute("raycaster", "objects: .clickable");
});

//  Track when intro video reaches the menu moment
introVideo.addEventListener("timeupdate", () => {
  if (introVideo.duration - introVideo.currentTime <= 4) {
    introVideoPauseTime = introVideo.currentTime; // Save the timestamp
  }
});

// Click Events for Switching Videos
document.getElementById("ommlab").addEventListener("click", () => switchVideo("scene-two-video"));
document.getElementById("anatomy").addEventListener("click", () => switchVideo("scene-three-video"));
document.getElementById("clinical").addEventListener("click", () => switchVideo("scene-four-video"));
document.getElementById("translation").addEventListener("click", () => switchVideo("scene-five-video"));
document.getElementById("cafe").addEventListener("click", () => switchVideo("scene-six-video"));
document.getElementById("study").addEventListener("click", () => switchVideo("scene-seven-video"));
document.getElementById("fitness").addEventListener("click", () => switchVideo("scene-eight-video"));
document.getElementById("admin").addEventListener("click", () => switchVideo("scene-nine-video"));

//  Button Hover Effects
document.querySelectorAll(".clickable").forEach((button) => {
  button.addEventListener("mouseenter", () => {
    button.setAttribute("scale", "1.1 1.1 1");
    button.setAttribute("material", "color: #FFFF00");
  });

  button.addEventListener("mouseleave", () => {
    button.setAttribute("scale", "1 1 1");
    button.setAttribute("material", "color: #FFFFFF");
  });

  button.addEventListener("click", () => {
    console.log(`${button.id} clicked!`);
  });
});


</script>

</body>
</html>
